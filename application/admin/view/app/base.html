{extend name='main'}

{block name="style"}
<style>
    .think-box-shadow {
        min-width: 1250px;
    }

    .app-detail-left {
        width: 20%;
        min-height: 700px;
        background-color: #2C333D;
        float: left;
        margin-left: 20px;
    }

    .app-left-top {
        margin-top: 10px;
        text-align: center;
    }

    .app-left-top img {
        width: 32%;
    }

    .app-left-top .app-name {
        font-size: 16px;
        color: #fff;
        margin: 17px 0 6px 0;
    }

    .app-left-top .app-key {
        font-size: 17px;
        color: #fff;
    }

    .app-left-botton {
        margin-top: 31px;
        margin-left: 20px;
    }

    .app-left-botton-1 {
        font-size: 16px;
        color: #7c7c7c;
    }

    .app-left-botton-title {
        font-size: 17px;
        color: #fff;
    }

    .yuan {
        width: 14px;
        height: 14px;
        border-radius: 8px;
        background-color: #ccc;
        margin-right: 7px;
        display: inline-block;
    }

    .app-left-botton-title-text {
        line-height: 34px;
        cursor: pointer;
    }

    .app-detail-right {
        float: left;
        width: 73%;
        margin: 0 33px 0 15px;
        min-height: 700px;
        /*border: 1px #000000 solid;*/
    }

    .app-detail-right .layui-tab-card {
        padding: 20px 25px;
    }

    .duan-input {
        width: 24%;
        height: 30px;
        display: inline-block;
        margin-right: 33px;
        margin-left: 19px;
    }

    .d-submit {
        width: 8%;
        height: 30px;
        border-radius: 3px;
        border: 1px #000 solid;
        background-color: #fff;
    }

    .chang-input {
        width: 60%;
        display: inline-block;
        margin-left: 67px;
        margin-right: 33px;
    }

    .fabu {
        display: inline-block;
        margin-left: 19px;
    }

    .app-upload {
        margin-left: 19px;
    }

    .app-upload-text {
        margin: 0 19px;
    }

    .shangchuan {
        margin-left: 68px;
    }

    .layui-form-switch {
        margin-top: 0;
    }

    .layui-input-block {
        margin-left: 67px;
    }

    .layui-form-radio {
        margin-top: 0;
    }

    .fanhui {
        margin-left: 20px;
        margin-bottom: 10px;

    }


    .app-domain-hr {
        /*text-align: center;*/

    }

    .app-domain-hr1 {
        float: left;
        width: 150px;
        margin-right: 40px;
    }

    .app-domain-hr2 {
        float: left;
        width: 150px;
        margin-right: 40px;
    }

    .app-domain-hr3 {
        float: left;
        width: 250px;
        margin-right: 40px;
    }

    .app-domain-textarea {
        height: 38px;
        min-height: 38px;
    }

    .app-domain-add {
        clear: both;
    }

    .app-domain-contain {
        margin: 10px auto;
    }

    .muban-save {
        margin: 50px auto 20PX;
        text-align: center;
    }
</style>
{/block}
{block name="button"}

{if auth("add")}
<button data-modal='{:url("add")}' data-title="添加APP" class='layui-btn layui-btn-sm layui-btn-primary'>添加APP</button>
{/if}

{if auth("remove")}
<button data-action='{:url("remove")}' data-rule="id#{key}" data-csrf="{:systoken('remove')}"
        data-confirm="确定要删除这些APP吗？" class='layui-btn layui-btn-sm layui-btn-primary'>删除APP
</button>
{/if}

{/block}

{block name="content"}
<div class="think-box-shadow">
    <a data-open="{:url('app/index')}">
        <button type="button" class="layui-btn layui-btn-primary fanhui">返回</button>
    </a>

    <div class="app-detail">
        {include file="app/left" /}
        <div class="app-detail-right">
            <form class="layui-form layui-card" action="{:request()->url()}" data-auto="true" method="post"
                  autocomplete="off">
                <div class="layui-card-body layui-tab-card">
                    <div class="layui-form-item">
                        <label class="relative block">
                            <span class="color-green font-w7">应用名称</span>
                            <input value='{$row.name}' name="name" class="layui-input duan-input app-value">
                        </label>
                    </div>
                    <div class="layui-form-item">
                        <label class="relative block">
                            <span class="color-green font-w7">创建时间</span>
                            <input value='{$row.created_at|format_datetime}' class="layui-input duan-input" disabled>
                        </label>
                    </div>
                    <div class="layui-form-item">
                        <label class="relative block">
                            <span class="color-green font-w7">AppKey</span>
                            <input value='{$row.app_key}' class="layui-input duan-input" disabled>
                        </label>
                    </div>
                    <div class="layui-form-item">
                        <label class="relative block" style="float: left">
                            <span class="color-green font-w7">应用图标</span>
                        </label>
                        <div class="shangchuan">
                            <input name="img" type="hidden" value="{$row.img}" class="app-value">
                            <span class="app-upload-text">请上传你的应用图标(大小不超过1M)</span>
                            <script>
                                $('[name="img"]').uploadOneImage()
                            </script>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="relative block" style="float: left">
                            <span class="color-green font-w7">下载方式</span>
                        </label>
                        <div class="layui-input-block">
                            <input type="radio" name="download_type" value="1" title="链接下载" lay-filter="download_type"
                                   {$row.download_type== 1 ? 'checked' : ''}>
                            <input type="radio" name="download_type" value="2" title="openInstall"
                                   lay-filter="download_type" {$row.download_type== 2 ? 'checked' : ''}>
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="relative block" style="float: left">
                            <span class="color-green font-w7">开关</span>
                        </label>
                        <div class="layui-input-block">
                            <input class="app-value" type="checkbox" value="1" name="status" lay-skin="switch"
                                   lay-text="开启|关闭" lay-filter="status" {$row.status== 1 ? 'checked' : ''}>
                        </div>
                    </div>


                    <div class="app-domain layui-tab-card">
                        <div class="app-domain-hr">
                            <div class="app-domain-hr1 color-green font-w7">域名</div>
                            <div class="app-domain-hr2 color-green font-w7">渠道号</div>
                            <div class="app-domain-hr3 color-green font-w7">统计代码</div>
                            <div class="clear"></div>
                        </div>

                        <div class="app-domain-muban layui-hide">
                            <div class="app-domain-contain">
                                <div class="app-domain-hr1">
                                    <input value='' disabled name="bind_v1[]" placeholder="请输入域名"
                                           class="layui-input">
                                </div>
                                <div class="app-domain-hr2">
                                    <input value='' disabled name="bind_v2[]" placeholder="请输入渠道号"
                                           class="layui-input">
                                </div>
                                <div class="app-domain-hr3">
                                <textarea placeholder="请输入统计代码" disabled class="layui-textarea app-domain-textarea"
                                          name="bind_v3[]"></textarea>
                                </div>
                                <div>
                                    <button type="button" class="layui-btn layui-btn-danger app-domain-del">删除</button>
                                </div>
                            </div>
                        </div>

                        <div class="app-domain-item app-domain-box">
                            {foreach $bindDomain as $k=>$v}
                            <div class="app-domain-contain">
                                <div class="app-domain-hr1">
                                    <input value='{$v.domain}' name="bind_v1[]" placeholder="请输入域名" class="layui-input">
                                </div>
                                <div class="app-domain-hr2">
                                    <input value='{$v.channel_code}' name="bind_v2[]" placeholder="请输入渠道号"
                                           class="layui-input">
                                </div>
                                <div class="app-domain-hr3">
                                <textarea placeholder="请输入统计代码" class="layui-textarea app-domain-textarea"
                                          name="bind_v3[]">{$v.statistics_code}</textarea>
                                </div>
                                <div>
                                    <button type="button" class="layui-btn layui-btn-danger app-domain-del">删除</button>
                                </div>
                            </div>
                            {/foreach}

                        </div>
                        <div>
                            <button type="button" class="layui-btn  app-domain-add">新增</button>
                        </div>
                        <div class="clear"></div>
                    </div>

                    <input type="hidden" name="id" value="{$row.id}">

                    <div class="layui-form-item muban-save">
                        <button class="layui-btn muban-save-btn" type='submit' lay-filter="formDemo">保存数据</button>
                    </div>
                </div>
            </form>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
    $(".app-domain-del").click(function (obj) {
        $(this).parent().parent().remove();
    });

    $(".app-domain-add").click(function (obj) {
        $item = $(".app-domain-muban").children().eq(0).clone(true);
        $item.find('input,textarea').attr('disabled', false);
        $('.app-domain-box').append($item);
    });


</script>
{/block}
{block name='script'}
<script>
    form.render();
</script>
{/block}
